<?php
	$id = generateRandomString(16);
	RegisterNewTrackerID($id);
	echo "<script type='text/javascript'>document.location.replace('../zeldaTracker/tracking?trackerID=".$id."');</script>";
	
	function GetSQLConnexion()
	{
		return new PDO("mysql:host=87.98.175.104;dbname=Resnox;charset=utf8", "Resnox", "abastortu1998-", array(PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION));
	}
		
	function RegisterNewTrackerID($trackerID)
	{
		$bdd = GetSQLConnexion();
		try
		{
			$string_request1 = "INSERT INTO `oot_rando_tracker_item` (`trackerID`, `kokiriSword`, `kokiriMido1`, `kokiriMido2`, `kokiriMido3`, `kokiriMido4`, `kokiriSoS`, `sfmGrotto`, `sfmSaria`, `sfmMinuet`, `lwSaria`, `lwScrub`, `lwSkullKid`, `lwSlingshot`, `lwOcarina`, `lwGrottoGC`, `lwGrottoSFM`, `lwSkullMask`, `dekuMap`, `dekuSlingshot`, `dekuNearSlingshot`, `dekuCompass`, `dekuNearCompass`, `dekuBasement`, `dekuGohma`, `dekuStone`, `forestFirst`, `forestStalfos`, `forestMap`, `forestScarecrow`, `forestWell`, `forestFloormaster`, `forestBlocks`, `forestBK`, `forestRedPoe`, `forestBow`, `forestBluePoe`, `forestCheckboard`, `forestBasement`, `forestGanon`, `forestStone`, `dmtAboveDC`, `dmtWall`, `dmtGrotto`, `dmtFairy`, `dmtBiggoron`, `dmcWall`, `dmcVolcano`, `dmcFairy`, `dmcGrotto`, `dmcBolero`, `gcDarunia`, `gcPot`, `gcHotRod`, `gcLink`, `gcBoulderL`, `gcBoulderR`, `gcBoulderH`, `dcMap`, `dcCompass`, `dcPlatform`, `dcBomb`, `dcBridge`, `dcBoss`, `dcKD`, `dcStone`, `fireBoss`, `fireFlare`, `fireBK`, `fireBridgeL`, `fireBridgeR`, `fireBoulderGoron`, `fireBoulderCave`, `fireBoulderTop`, `fireShortcut`, `fireScarecrow`, `fireMap`, `fireCompass`, `fireGoronHammer`, `fireHammer`, `fireVolvagia`, `fireStone`, `fieldMarket`, `fieldDive`, `fieldScrub`, `fieldOpen`, `fieldSoutheast`, `fieldOOTSong`, `fieldOOTItem`, `llcTalon`, `llcEpona`, `llcHeart`, `zrPilar`, `zrDomain`, `zrGrotto`, `zrFrogs1`, `zrFrogs2`, `zdDive`, `zdTorch`, `zdKZ`, `zfFairy`, `zfIceberg`, `zfBottom`, `jabuBoomerang`, `jabuMap`, `jabuCompass`, `jabuBarinade`, `jabuStone`, `icMap`, `icCompass`, `icHeart`, `icBoots`, `icSerenade`, `marketSlingshot`, `marketBowling1`, `marketBowling2`, `marketRichard`, `marketCMG`, `marketPoe`, `hcMalon`, `hcLullaby`, `hcFairy`, `totMaster`, `totPrelude`, `totLACS`, `outGanonFairy`, `ganonForest`, `ganonWater1`, `ganonWater2`, `ganonShadow1`, `ganonShadow2`, `ganonLight1`, `ganonLight2`, `ganonLight3`, `ganonLight4`, `ganonLight5`, `ganonLight6`, `ganonLight7`, `ganonLight8`, `ganonSpirit1`, `ganonSpirit2`, `ganonBK`, `lakeFishC`, `lakeFishA`, `lakeRuto`, `lakeLabT`, `lakeLabD`, `lakeSun`, `waterMap`, `waterCrack`, `waterTorches`, `waterCompass`, `waterBasement`, `waterEye`, `waterLongshot`, `waterRiver`, `waterDragon`, `waterBK`, `waterMorpha`, `waterStone`, `kakRedead`, `kakGrotto`, `kakAnjuC`, `kakAnjuA`, `kakCow`, `kakArchery`, `kakRoof`, `kakWindmill`, `kak10Skull`, `kak20Skull`, `kak30Skull`, `kak40Skull`, `kak50Skull`, `kakStorm`, `kakNocturne`, `graveShield`, `graveDampeT`, `graveDampeR1`, `graveDampeR2`, `graveRedead`, `graveCrate`, `graveTorches`, `graveSun`, `botwFrontBomb`, `botwFrontHidden`, `botwCompass`, `botwSmallCenter`, `botwRightHidden`, `botwBeamosRoom`, `botwLike`, `botwMap`, `botwBackBomb`, `botwLeftWater`, `botwCoffin`, `botwFrontWater`, `botwInvisible`, `botwLens`, `shadowMap`, `shadowHover`, `shadowCompass`, `shadowSilver`, `shadowInvisibleL`, `shadowInvisibleR`, `shadowSpikeL`, `shadowSpikeHB`, `shadowSpikeHI`, `shadowRedead`, `shadowPot`, `shadowWind`, `shadowGibdosK`, `shadowGibdosH`, `shadowBK`, `shadowNearBK`, `shadowFloormaster`, `shadowBongo`, `shadowStone`, `valleyCrate`, `valleyWaterfall`, `valleyHammer`, `fortressGMC`, `fortressRoof`, `fortressArchery10`, `fortressArchery15`, `wastelandTorches`, `colossusFairy`, `colossusArch`, `colossusRequiem`, `gtgLobby1`, `gtgLobby2`, `gtgStalfos`, `gtgWolfos`, `gtgLike1`, `gtgLike2`, `gtgLike3`, `gtgLike4`, `gtgStatue`, `gtgAboveStatue`, `gtgFlamingC`, `gtgFlamingE`, `gtgBeamos`, `gtgStanding`, `gtgMazeR1`, `gtgMazeR2`, `gtgToilets`, `gtgFake`, `gtgLeft1`, `gtgLeft2`, `gtgLeft3`, `gtgIce`, `spiritChild1`, `spiritChild2`, `spiritLizalfos1`, `spiritLizalfos2`, `spiritMap`, `spiritTorches`, `spiritStrength`, `spiritCompass`, `spiritBoulder`, `spiritFloormaster1`, `spiritFloormaster2`, `spiritLullaby1`, `spiritLullaby2`, `spiritInvisibleL`, `spiritInvisibleR`, `spiritArmos`, `spiritMirror`, `spiritBK`, `spiritTopmost`, `spiritTwinrova`, `spiritStone`, `currentScarecrow`, `currentBean`, `currentMask`, `currentBGS`) VALUES ('".$trackerID."', '0', '0', '0', '0', '0', '0', '0', '0', '0', '121', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '122', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '99', '0', '0', '26', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '140', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0');";
			$req1 = $bdd->query($string_request1);
		}
		catch (Exception $e)
		{
			return null;
		}
		
		try
		{
			$string_request2 = "INSERT INTO `oot_rando_tracker_hint` (`trackerID`, `kokiriSword`, `kokiriMido1`, `kokiriMido2`, `kokiriMido3`, `kokiriMido4`, `kokiriSoS`, `sfmGrotto`, `sfmSaria`, `sfmMinuet`, `lwSaria`, `lwScrub`, `lwSkullKid`, `lwSlingshot`, `lwOcarina`, `lwGrottoGC`, `lwGrottoSFM`, `lwSkullMask`, `dekuMap`, `dekuSlingshot`, `dekuNearSlingshot`, `dekuCompass`, `dekuNearCompass`, `dekuBasement`, `dekuGohma`, `dekuStone`, `forestFirst`, `forestStalfos`, `forestMap`, `forestScarecrow`, `forestWell`, `forestFloormaster`, `forestBlocks`, `forestBK`, `forestRedPoe`, `forestBow`, `forestBluePoe`, `forestCheckboard`, `forestBasement`, `forestGanon`, `forestStone`, `dmtAboveDC`, `dmtWall`, `dmtGrotto`, `dmtFairy`, `dmtBiggoron`, `dmcWall`, `dmcVolcano`, `dmcFairy`, `dmcGrotto`, `dmcBolero`, `gcDarunia`, `gcPot`, `gcHotRod`, `gcLink`, `gcBoulderL`, `gcBoulderR`, `gcBoulderH`, `dcMap`, `dcCompass`, `dcPlatform`, `dcBomb`, `dcBridge`, `dcBoss`, `dcKD`, `dcStone`, `fireBoss`, `fireFlare`, `fireBK`, `fireBridgeL`, `fireBridgeR`, `fireBoulderGoron`, `fireBoulderCave`, `fireBoulderTop`, `fireShortcut`, `fireScarecrow`, `fireMap`, `fireCompass`, `fireGoronHammer`, `fireHammer`, `fireVolvagia`, `fireStone`, `fieldMarket`, `fieldDive`, `fieldScrub`, `fieldOpen`, `fieldSoutheast`, `fieldOOTSong`, `fieldOOTItem`, `llcTalon`, `llcEpona`, `llcHeart`, `zrPilar`, `zrDomain`, `zrGrotto`, `zrFrogs1`, `zrFrogs2`, `zdDive`, `zdTorch`, `zdKZ`, `zfFairy`, `zfIceberg`, `zfBottom`, `jabuBoomerang`, `jabuMap`, `jabuCompass`, `jabuBarinade`, `jabuStone`, `icMap`, `icCompass`, `icHeart`, `icBoots`, `icSerenade`, `marketSlingshot`, `marketBowling1`, `marketBowling2`, `marketRichard`, `marketCMG`, `marketPoe`, `hcMalon`, `hcLullaby`, `hcFairy`, `totMaster`, `totPrelude`, `totLACS`, `outGanonFairy`, `ganonForest`, `ganonWater1`, `ganonWater2`, `ganonShadow1`, `ganonShadow2`, `ganonLight1`, `ganonLight2`, `ganonLight3`, `ganonLight4`, `ganonLight5`, `ganonLight6`, `ganonLight7`, `ganonLight8`, `ganonSpirit1`, `ganonSpirit2`, `ganonBK`, `lakeFishC`, `lakeFishA`, `lakeRuto`, `lakeLabT`, `lakeLabD`, `lakeSun`, `waterMap`, `waterCrack`, `waterTorches`, `waterCompass`, `waterBasement`, `waterEye`, `waterLongshot`, `waterRiver`, `waterDragon`, `waterBK`, `waterMorpha`, `waterStone`, `kakRedead`, `kakGrotto`, `kakAnjuC`, `kakAnjuA`, `kakCow`, `kakArchery`, `kakRoof`, `kakWindmill`, `kak10Skull`, `kak20Skull`, `kak30Skull`, `kak40Skull`, `kak50Skull`, `kakStorm`, `kakNocturne`, `graveShield`, `graveDampeT`, `graveDampeR1`, `graveDampeR2`, `graveRedead`, `graveCrate`, `graveTorches`, `graveSun`, `botwFrontBomb`, `botwFrontHidden`, `botwCompass`, `botwSmallCenter`, `botwRightHidden`, `botwBeamosRoom`, `botwLike`, `botwMap`, `botwBackBomb`, `botwLeftWater`, `botwCoffin`, `botwFrontWater`, `botwInvisible`, `botwLens`, `shadowMap`, `shadowHover`, `shadowCompass`, `shadowSilver`, `shadowInvisibleL`, `shadowInvisibleR`, `shadowSpikeL`, `shadowSpikeHB`, `shadowSpikeHI`, `shadowRedead`, `shadowPot`, `shadowWind`, `shadowGibdosK`, `shadowGibdosH`, `shadowBK`, `shadowNearBK`, `shadowFloormaster`, `shadowBongo`, `shadowStone`, `valleyCrate`, `valleyWaterfall`, `valleyHammer`, `fortressGMC`, `fortressRoof`, `fortressArchery10`, `fortressArchery15`, `wastelandTorches`, `colossusFairy`, `colossusArch`, `colossusRequiem`, `gtgLobby1`, `gtgLobby2`, `gtgStalfos`, `gtgWolfos`, `gtgLike1`, `gtgLike2`, `gtgLike3`, `gtgLike4`, `gtgStatue`, `gtgAboveStatue`, `gtgFlamingC`, `gtgFlamingE`, `gtgBeamos`, `gtgStanding`, `gtgMazeR1`, `gtgMazeR2`, `gtgToilets`, `gtgFake`, `gtgLeft1`, `gtgLeft2`, `gtgLeft3`, `gtgIce`, `spiritChild1`, `spiritChild2`, `spiritLizalfos1`, `spiritLizalfos2`, `spiritMap`, `spiritTorches`, `spiritStrength`, `spiritCompass`, `spiritBoulder`, `spiritFloormaster1`, `spiritFloormaster2`, `spiritLullaby1`, `spiritLullaby2`, `spiritInvisibleL`, `spiritInvisibleR`, `spiritArmos`, `spiritMirror`, `spiritBK`, `spiritTopmost`, `spiritTwinrova`, `spiritStone`, `currentScarecrow`, `currentBean`, `currentMask`, `currentBGS`) VALUES ('".$trackerID."', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0');";
			$req2 = $bdd->query($string_request2);
		}
		catch (Exception $e)
		{
			return null;
		}
		
		try
		{
			$string_request3 = "INSERT INTO `oot_rando_tracker_zone` (`trackerID`, `kokiri`, `sfm`, `lw`, `dmt`, `dmc`, `gc`, `field`, `ranch`, `river`, `domain`, `zf`, `market`, `hc`, `tot`, `outGanon`, `lh`, `kak`, `graveyard`, `valley`, `fortress`, `wasteland`, `colossus`, `deku`, `dc`, `jabu`, `iceCavern`, `botw`, `gtg`, `forest`, `fire`, `water`, `shadow`, `spirit`, `ganon`) VALUES ('".$trackerID."', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0');";
			$req3 = $bdd->query($string_request3);
		}
		catch (Exception $e)
		{
			return null;
		}
	}
	
	function generateRandomString($length) 
	{
		$characters = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
		$charactersLength = strlen($characters);
		$randomString = '';
		for ($i = 0; $i < $length; $i++) 
		{
			$randomString .= $characters[rand(0, $charactersLength - 1)];
		}
		return $randomString;
	}
?>